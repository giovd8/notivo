<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOpen]="true"
  [cdkConnectedOverlayOrigin]="overlayOrigin"
  [cdkConnectedOverlayPositions]="positions"
  [cdkConnectedOverlayScrollStrategy]="scrollStrategy()"
  [cdkConnectedOverlayHasBackdrop]="true"
  [cdkConnectedOverlayBackdropClass]="['opacity-0']"
  (backdropClick)="onClose.emit()"
  (detach)="onClose.emit()"
>
  <div class="relative z-[1000]" [style.width.px]="originWidth()">
    <div class="left-1/2 -translate-x-1/2 absolute top-2.5 z-50">
      <div
        class="absolute -top-1.5 left-1/2 -translate-x-1/2 w-0 h-0 border-x-8 border-x-transparent border-b-8 border-white"
      ></div>
      <div class="absolute -top-[7px] left-1/2 -translate-x-1/2 w-0 h-0">
        <div class="absolute top-0 w-px h-[9px] bg-gray-200 origin-top rotate-45"></div>
        <div class="absolute top-0 w-px h-[9px] bg-gray-200 origin-top -rotate-45"></div>
      </div>
    </div>
    <div class="absolute top-[9px] flex flex-col items-center z-40 w-full">
      <ul class="notivo-card max-h-[250px] overflow-y-auto w-full !p-0.5" notivoFocusHandler>
        @if (isLoading()) {
        <div class="m-1 px-8 py-2 rounded-xl flex justify-center">
          <i class="bi bi-spinner-fill animate-spin"></i>
        </div>
        } @else { @if (showSearchBar() && isMultiselect()) {
        <div class="p-2 z-[100] sticky top-0">
          <notivo-search-bar (searchStringChange)="query.set($event)"></notivo-search-bar>
        </div>
        } @for (option of optionsFiltered(); let i = $index; track i) {
        <li
          (click)="onOptionSelected.emit(option)"
          [id]="'option-' + i"
          data-focusable
          class="flex justify-between items-center gap-4 m-1 px-4 py-2 relative rounded-xl text-sm z-50"
          [tabIndex]="i"
        >
          <div class="flex flex-col">
            <div class="flex items-center gap-2">
              @if (isMultiselect() && hasCheck(option)) {
              <input
                [checked]="option?.isChecked"
                class="accent-primary !cursor-pointer"
                readonly
                type="checkbox"
              />
              }
              <span class="capitalize">{{ option.label }}</span>
            </div>
          </div>
        </li>
        @if (i !== optionsFiltered().length - 1) {
        <hr class="my-1 border-gray-200 px-2" />
        } } @empty {
        <li class="m-1 px-8 py-2 relative rounded-xl text-sm text-center">
          Nessun risultato trovato
        </li>
        } }
      </ul>
    </div>
  </div>
</ng-template>
<!--}-->
